% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulateTumor.R
\name{simulateTumor}
\alias{simulateTumor}
\title{Simulate tumor clonal evolution with realistic noise}
\usage{
simulateTumor(
  subclone_freqs = c(0.15, 0.25, 0.3, 0.3),
  n_mut_per_clone = c(20, 25, 30, 15),
  n_mut_founder = 10,
  n_mut_shared = list(`2 3 4` = 15, `3 4` = 12, `1 2` = 8),
  biological_noise = list(enabled = TRUE, concentration = 50),
  sequencing_noise = list(enabled = TRUE, mean_depth = 100, depth_variation =
    "negative_binomial", depth_dispersion = 20, error_rate = 0.001, binomial_sampling =
    TRUE),
  germline_variants = list(enabled = FALSE, n_variants = 50, vaf_expected = 0.5),
  seed = NULL
)
}
\arguments{
\item{subclone_freqs}{numeric vector, frequencies of each subclone (must sum to <= 1).
Default: c(0.15, 0.25, 0.30, 0.30)}

\item{n_mut_per_clone}{integer vector, number of private mutations per clone.
Default: c(20, 25, 30, 15)}

\item{n_mut_founder}{integer, number of founder mutations (present in all clones).
Default: 10}

\item{n_mut_shared}{named list, shared mutations between clone groups.
Names indicate which clones (e.g., "2 3 4"), values are mutation counts.
Default: list("2 3 4" = 15, "3 4" = 12, "1 2" = 8)}

\item{biological_noise}{list with biological noise parameters:
\itemize{
  \item enabled: logical, enable biological noise (default: TRUE)
  \item concentration: numeric, Beta distribution concentration (default: 50)
}}

\item{sequencing_noise}{list with sequencing noise parameters:
\itemize{
  \item enabled: logical, enable sequencing noise (default: TRUE)
  \item mean_depth: numeric, average coverage (default: 100)
  \item depth_variation: character, distribution type (default: "negative_binomial")
  \item depth_dispersion: numeric, dispersion parameter (default: 20)
  \item error_rate: numeric, base miscall rate (default: 0.001)
  \item binomial_sampling: logical, use binomial sampling (default: TRUE)
}}

\item{germline_variants}{list with germline variant parameters:
\itemize{
  \item enabled: logical, include germline variants (default: FALSE)
  \item n_variants: integer, number of germline variants to simulate (default: 50)
  \item vaf_expected: numeric, expected VAF for heterozygous germline (default: 0.5)
}
Germline variants will have VAF adjusted by tumor purity:
observed_VAF = germline_vaf * tumor_purity + 0.5 * (1 - tumor_purity)}

\item{seed}{integer, random seed for reproducibility. Default: 123}
}
\value{
ClonalSimData object containing mutations, parameters, and metadata
}
\description{
Main function to simulate a heterogeneous tumor sample with
  hierarchical clonal structure, including realistic biological and technical
  sequencing noise.
}
\examples{
# Basic simulation with default parameters
sim <- simulateTumor()
show(sim)
plot(sim)

# Custom clonal structure
sim <- simulateTumor(
  subclone_freqs = c(0.2, 0.3, 0.5),
  n_mut_per_clone = c(30, 40, 30)
)

# Low purity tumor (40\% purity)
sim <- simulateTumor(
  subclone_freqs = c(0.1, 0.15, 0.15),
  n_mut_per_clone = c(20, 25, 30)
)

# High coverage sequencing
sim <- simulateTumor(
  sequencing_noise = list(
    enabled = TRUE,
    mean_depth = 500,
    depth_dispersion = 100
  )
)

# No noise (ideal data for testing)
sim <- simulateTumor(
  biological_noise = list(enabled = FALSE),
  sequencing_noise = list(enabled = FALSE)
)

# Include germline variants
sim <- simulateTumor(
  subclone_freqs = c(0.3, 0.4),  # 70\% purity
  n_mut_per_clone = c(40, 50),
  germline_variants = list(enabled = TRUE, n_variants = 100)
)

}
