% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/noise_model.R
\name{simulateDepth}
\alias{simulateDepth}
\title{Simulate realistic sequencing depth}
\usage{
simulateDepth(
  n_mutations,
  mean_depth = 100,
  distribution = "negative_binomial",
  dispersion = 20
)
}
\arguments{
\item{n_mutations}{integer, number of mutations}

\item{mean_depth}{numeric, mean sequencing coverage. Default: 100}

\item{distribution}{character, distribution type: "negative_binomial"
(realistic, default), "poisson" (simpler), or "uniform" (for testing)}

\item{dispersion}{numeric, size parameter for negative binomial. Lower values
= more variable coverage. Default: 20}
}
\value{
integer vector of depth values
}
\description{
Simulates sequencing coverage with realistic overdispersion
  using negative binomial distribution, which better captures real NGS
  variability compared to Poisson.
}
\details{
The negative binomial distribution allows overdispersion (variance > mean),
which occurs in real sequencing due to:
\itemize{
  \item GC content bias
  \item Mappability differences
  \item PCR amplification artifacts
}

The dispersion parameter controls variability: lower values produce more
variable coverage across positions.
}
\examples{
# Realistic depth with overdispersion
depth_realistic <- simulateDepth(1000, mean_depth = 100, dispersion = 20)
hist(depth_realistic, main = "Realistic depth", xlab = "Depth")

# More variable coverage (low dispersion)
depth_variable <- simulateDepth(1000, mean_depth = 100, dispersion = 10)

# Uniform coverage (for testing)
depth_uniform <- simulateDepth(1000, mean_depth = 100, distribution = "uniform")

}
