% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/noise_model.R
\name{applyBiologicalNoise}
\alias{applyBiologicalNoise}
\title{Apply biological noise using Beta distribution}
\usage{
applyBiologicalNoise(true_freq, n_mutations, concentration = 50)
}
\arguments{
\item{true_freq}{numeric, the true allele frequency (0-1)}

\item{n_mutations}{integer, number of mutations to generate}

\item{concentration}{numeric, concentration parameter for Beta distribution
(alpha + beta). Higher values = less variability. Default: 50}
}
\value{
numeric vector of VAF values with biological noise
}
\description{
Simulates intra-tumor heterogeneity using a Beta distribution.
  The Beta distribution is more realistic than Gaussian for frequency data
  as it is naturally bounded between 0 and 1.
}
\details{
For a clone with true frequency \code{f}, VAF values are sampled from
Beta(α, β) where:
\itemize{
  \item α = f × concentration
  \item β = (1-f) × concentration
}

Higher concentration values result in VAF closer to the expected frequency,
while lower values increase spread, simulating spatial/temporal heterogeneity.
}
\examples{
# Generate 100 mutations with true frequency 0.3 and moderate heterogeneity
vaf <- applyBiologicalNoise(0.3, 100, concentration = 50)
hist(vaf, main = "VAF with biological noise", xlab = "VAF")

# High heterogeneity (low concentration)
vaf_high_het <- applyBiologicalNoise(0.3, 100, concentration = 20)

# Low heterogeneity (high concentration)
vaf_low_het <- applyBiologicalNoise(0.3, 100, concentration = 100)

}
