% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/noise_model.R
\name{simulateSequencingReads}
\alias{simulateSequencingReads}
\title{Simulate sequencing reads with binomial sampling}
\usage{
simulateSequencingReads(true_vaf, depth, error_rate = 0.001)
}
\arguments{
\item{true_vaf}{numeric vector, true variant allele frequencies}

\item{depth}{integer vector, sequencing depth at each position}

\item{error_rate}{numeric, base miscall rate (0-1). Default: 0.001 (0.1%,
typical for Illumina)}
}
\value{
list with three components:
  \itemize{
    \item vaf: observed VAF values
    \item alt_reads: alternative allele read counts
    \item ref_reads: reference allele read counts
  }
}
\description{
Simulates stochastic read counts using binomial distribution,
  which models the independent sampling of each sequencing read.
}
\details{
Each sequencing read is independently sampled from the DNA pool. Given a
true VAF and depth D, the number of alternative reads follows a binomial
distribution: alt_reads ~ Binomial(D, VAF).

This introduces natural sampling variation, with higher uncertainty at:
\itemize{
  \item Low sequencing depth
  \item Low variant frequency
}

The error_rate parameter simulates base miscalls from sequencer optical/
chemistry errors.
}
\examples{
# Simulate reads for mutations at VAF 0.3 with depth 100
true_vaf <- rep(0.3, 100)
depth <- rep(100, 100)
reads <- simulateSequencingReads(true_vaf, depth)

# Observed VAF varies due to sampling
hist(reads$vaf, main = "Observed VAF", xlab = "VAF")
abline(v = 0.3, col = "red", lty = 2)

# Check alt_reads distribution
hist(reads$alt_reads, main = "Alt read counts", xlab = "Alt reads")

}
