Checking for deprecated package usage... OK
Checking for remote package usage... OK
Checking for 'LazyData: true' usage... OK
Checking version number... OK
Checking new package version number... OK
Checking R version dependency... OK
Checking package size... OK
Checking individual file sizes... OK
Checking biocViews... OK
Checking that biocViews are present... OK
Checking package type based on biocViews... OK
Checking for non-trivial biocViews... OK
Checking that biocViews come from the same category... OK
Checking biocViews validity... OK
Checking for recommended biocViews...
Consider adding these automatically suggested biocViews: Spatial
Checking build system compatibility... OK
Checking for proper Description: field... OK
Checking if DESCRIPTION is well formatted... OK
Checking for whitespace in DESCRIPTION field names... OK
Checking that Package field matches directory/tarball name... OK
Checking for Version: field... OK
Checking for valid maintainer... OK
Checking License: for restrictive use... OK
Checking for recommended DESCRIPTION fields... OK
Checking for Bioconductor software dependencies... OK
Checking for pinned package versions in DESCRIPTION... OK
Checking for 'fnd' role in Authors@R...
No 'fnd' role found in Authors@R. If the work is supported
        by a grant, consider adding the 'fnd' role to the list of authors.
Checking .Rbuildignore... OK
Checking for stray BiocCheck output folders... OK
Checking for inst/doc folders... OK
Checking vignette directory... OK
Checking package installation calls in R code... OK
Checking for library/require of ClonalSim... OK
Checking coding practice...
 Avoid 1:...; use seq_len() or seq_along()
Found in files:
simulateTumor.R (line 242, column 52)
Avoid redundant 'stop' and 'warn*' in signal conditions
Found in files:
R/noise_model.R (line 187, column 10)
 Remove set.seed usage (found 1 times)
set.seed() in R/simulateTumor.R (line 118, column 5)
Checking parsed R code in R directory, examples, vignettes... OK
Checking function lengths...
The recommended function length is 50 lines or less. There are 3 functions greater than 50 lines.
The longest 5 functions are:
simulateTumor() (R/simulateTumor.R): 209 lines
_anonymous_.141() (R/methods.R): 140 lines
.generate_mutations() (R/simulateTumor.R):  64 lines
Checking man page documentation...
Usage of dontrun{} / donttest{} tags found in man page examples. 22% of man pages use at least one of these tags.
Found in files:
plot-ClonalSimData-missing-method.Rd
toDataFrame.Rd
toPyClone.Rd
toSciClone.Rd
toVCF.Rd
Use donttest{} instead of dontrun{}.
Found in files:
plot-ClonalSimData-missing-method.Rd
toDataFrame.Rd
toPyClone.Rd
toSciClone.Rd
toVCF.Rd
Checking package NEWS... OK
Checking unit tests... OK
Checking skip_on_bioc() in tests... OK
Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
Consider shorter lines; 31 lines (2%) are > 80 characters long.
First few lines:
R/AllClasses.R#L106     if (any(object@mutations$VAF < 0 | o ...
R/AllClasses.R#L116     if (any(object@mutations$Alt_reads > ...
R/ClonalSim-package.R#L4 #' ClonalSim: Simulation of Tumor Clonal ...
R/ClonalSim-package.R#L42 #'   \item \strong{Benchmarking}: Test v ...
R/methods.R#L147       geom_density(fill = "#984EA3", alp ...
R/methods.R#L161                    linetype = "dashed",  ...
R/methods.R#L163                    linetype = "dashed",  ...
R/methods.R#L183       if (!is.null(params$germline_varia ...
R/methods.R#L195                      linetype = "dashed" ...
R/methods.R#L214     p <- ggplot(mutations, aes(x = seq_l ...
R/noise_model.R#L24 #' while lower values increase spread, s ...
R/noise_model.R#L100 #' depth_uniform <- simulateDepth(1000,  ...
R/noise_model.R#L200   # Ensure alt_reads doesn't exceed dept ...
R/simulateTumor.R#L7 #' @param subclone_freqs numeric vector, ...
R/simulateTumor.R#L11 #' @param n_mut_founder integer, number  ...
R/simulateTumor.R#L19 #'     \item concentration: numeric, Bet ...
R/simulateTumor.R#L25 #'     \item depth_variation: character, ...
R/simulateTumor.R#L33 #'     \item n_variants: integer, number ...
R/simulateTumor.R#L34 #'     \item vaf_expected: numeric, expe ...
vignettes/Introduction_to_ClonalSim.Rmd#L29 with realistic sequencing noise. It gene ...
vignettes/Introduction_to_ClonalSim.Rmd#L105 ClonalSim provides built-in plotting fun ...
vignettes/Introduction_to_ClonalSim.Rmd#L113 would appear in real sequencing data. Ex ...
vignettes/Introduction_to_ClonalSim.Rmd#L134 ```{r bio_noise_demo, fig.cap="Effect of ...
vignettes/Introduction_to_ClonalSim.Rmd#L153 hist(getTrueVAF(sim_high_het), main = "H ...
vignettes/Introduction_to_ClonalSim.Rmd#L195 Each sequencing read is independently sa ...
vignettes/Introduction_to_ClonalSim.Rmd#L295 Real tumor sequencing data contains both ...
vignettes/Introduction_to_ClonalSim.Rmd#L297 ```{r germline_variants, fig.cap="VAF di ...
vignettes/Introduction_to_ClonalSim.Rmd#L314 germline_vafs <- getMutations(sim_germli ...
vignettes/Introduction_to_ClonalSim.Rmd#L315 somatic_vafs <- getMutations(sim_germlin ...
vignettes/Introduction_to_ClonalSim.Rmd#L324 Key biological insight: Unlike somatic m ...
vignettes/Introduction_to_ClonalSim.Rmd#L330 This creates a characteristic peak at VA ...
Consider multiples of 4 spaces for line indents; 483 lines (25%) are not.
First few lines:
R/AllClasses.R#L32          slots = c( ...
R/AllClasses.R#L33            mutations = "data.frame", ...
R/AllClasses.R#L34            params = "list", ...
R/AllClasses.R#L35            clonal_structure = "data.fram ...
R/AllClasses.R#L36            metadata = "list" ...
R/AllClasses.R#L37          ), ...
R/AllClasses.R#L38          prototype = list( ...
R/AllClasses.R#L39            mutations = data.frame(), ...
R/AllClasses.R#L40            params = list(), ...
R/AllClasses.R#L41            clonal_structure = data.frame ...
R/AllClasses.R#L42            metadata = list() ...
R/AllClasses.R#L43          ) ...
R/AllClasses.R#L75                           params = list( ...
R/AllClasses.R#L76                           clonal_structu ...
R/AllClasses.R#L77                           metadata = lis ...
R/AllClasses.R#L78   new("ClonalSimData", ...
R/AllClasses.R#L79       mutations = mutations, ...
R/AllClasses.R#L80       params = params, ...
R/AllClasses.R#L81       clonal_structure = clonal_structur ...
R/AllClasses.R#L82       metadata = metadata) ...
R/AllClasses.R#L93   errors <- character() ...
R/AllClasses.R#L95   # Check mutations data.frame ...
R/AllClasses.R#L96   if (nrow(object@mutations) > 0) { ...
R/AllClasses.R#L98                        "True_VAF", "VAF" ...
R/AllClasses.R#L101       errors <- c(errors, paste("Missing ...
R/AllClasses.R#L107       errors <- c(errors, "VAF values mu ...
R/AllClasses.R#L112       errors <- c(errors, "Depth values  ...
R/AllClasses.R#L117       errors <- c(errors, "Alt_reads can ...
R/AllClasses.R#L119   } ...
R/AllClasses.R#L121   # Check params ...
R/AllClasses.R#L122   if (length(object@params) > 0) { ...
R/AllClasses.R#L124       freqs <- object@params$subclone_fr ...
R/AllClasses.R#L125       if (any(freqs < 0 | freqs > 1)) { ...
R/AllClasses.R#L127       } ...
R/AllClasses.R#L128       if (sum(freqs) > 1) { ...
R/AllClasses.R#L130       } ...
R/AllClasses.R#L132   } ...
R/AllClasses.R#L134   if (length(errors) == 0) TRUE else err ...
R/accessors.R#L19   stopifnot(inherits(object, "ClonalSimD ...
R/accessors.R#L20   object@mutations ...
R/accessors.R#L35   stopifnot(inherits(object, "ClonalSimD ...
R/accessors.R#L36   object@params ...
R/accessors.R#L51   stopifnot(inherits(object, "ClonalSimD ...
R/accessors.R#L52   object@mutations$True_VAF ...
R/accessors.R#L67   stopifnot(inherits(object, "ClonalSimD ...
R/accessors.R#L68   object@mutations$VAF ...
R/accessors.R#L83   stopifnot(inherits(object, "ClonalSimD ...
R/accessors.R#L84   object@clonal_structure ...
R/accessors.R#L99   stopifnot(inherits(object, "ClonalSimD ...
R/accessors.R#L100   object@metadata ...
R/bioconductor.R#L26   stopifnot(inherits(object, "ClonalSimD ...
R/bioconductor.R#L28   mutations <- object@mutations ...
R/bioconductor.R#L30   # Create GRanges object ...
R/bioconductor.R#L31   gr <- makeGRangesFromDataFrame( ...
R/bioconductor.R#L38   ) ...
R/bioconductor.R#L40   # Add additional metadata if not alrea ...
R/bioconductor.R#L41   if (include_metadata) { ...
R/bioconductor.R#L44                        "Depth", "Alt_rea ...
R/bioconductor.R#L49       if (col %in% colnames(mutations))  ...
R/bioconductor.R#L51       } ...
R/bioconductor.R#L53   } ...
R/bioconductor.R#L55   return(gr) ...
R/bioconductor.R#L89   stopifnot(inherits(object, "ClonalSimD ...
R/bioconductor.R#L91   mutations <- object@mutations ...
R/bioconductor.R#L93   # Filter out any mutations where ref = ...
R/bioconductor.R#L94   valid_mutations <- mutations[mutations ...
R/bioconductor.R#L96   if (nrow(valid_mutations) < nrow(mutat ...
R/bioconductor.R#L99   } ...
R/bioconductor.R#L101   # Create VRanges object ...
R/bioconductor.R#L102   vr <- VRanges( ...
R/bioconductor.R#L111   ) ...
R/bioconductor.R#L113   # Add custom INFO fields as metadata ...
R/bioconductor.R#L114   S4Vectors::mcols(vr)$TRUE_VAF <- valid ...
R/bioconductor.R#L115   S4Vectors::mcols(vr)$VAF <- valid_muta ...
R/bioconductor.R#L116   S4Vectors::mcols(vr)$CLONE <- valid_mu ...
R/bioconductor.R#L117   S4Vectors::mcols(vr)$TYPE <- valid_mut ...
R/bioconductor.R#L118   S4Vectors::mcols(vr)$CLONE_IDS <- vali ...
R/bioconductor.R#L120   # Write to file if specified ...
R/bioconductor.R#L121   if (!is.null(output_file)) { ...
R/bioconductor.R#L125   } ...
R/bioconductor.R#L127   return(vr) ...
R/bioconductor.R#L153   stopifnot(inherits(object, "ClonalSimD ...
R/bioconductor.R#L155   df <- object@mutations ...
R/bioconductor.R#L157   if (!include_true_vaf) { ...
R/bioconductor.R#L159   } ...
R/bioconductor.R#L161   if (!is.null(file)) { ...
R/bioconductor.R#L165   } ...
R/bioconductor.R#L167   return(df) ...
R/bioconductor.R#L190   stopifnot(inherits(object, "ClonalSimD ...
R/bioconductor.R#L192   mutations <- object@mutations ...
R/bioconductor.R#L194   # PyClone format ...
R/bioconductor.R#L195   pyclone_df <- data.frame( ...
R/bioconductor.R#L204   ) ...
R/bioconductor.R#L206   write.table(pyclone_df, file = file, s ...
R/bioconductor.R#L207               quote = FALSE) ...
R/bioconductor.R#L208   message("PyClone input written to: ",  ...
R/bioconductor.R#L210   return(invisible(pyclone_df)) ...
R/bioconductor.R#L231   stopifnot(inherits(object, "ClonalSimD ...
R/bioconductor.R#L233   mutations <- object@mutations ...
R/bioconductor.R#L235   # SciClone format ...
R/bioconductor.R#L236   sciclone_df <- data.frame( ...
R/bioconductor.R#L243   ) ...
R/bioconductor.R#L245   write.table(sciclone_df, file = file,  ...
R/bioconductor.R#L246               quote = FALSE) ...
R/bioconductor.R#L247   message("SciClone input written to: ", ...
R/bioconductor.R#L249   return(invisible(sciclone_df)) ...
R/methods.R#L14   cat("ClonalSimData object\n") ...
R/methods.R#L15   cat("================================= ...
R/methods.R#L16   cat("Number of mutations:", nrow(objec ...
R/methods.R#L18   if (length(object@params$subclone_freq ...
R/methods.R#L21                                      col ...
R/methods.R#L23   } ...
R/methods.R#L25   if (nrow(object@mutations) > 0) { ...
R/methods.R#L36   } ...
R/methods.R#L38   if (length(object@metadata) > 0) { ...
R/methods.R#L41       cat("  Created:", object@metadata$ ...
R/methods.R#L44       cat("  Package version:", object@m ...
R/methods.R#L46   } ...
R/methods.R#L62   stats <- list( ...
R/methods.R#L68       true = summary(object@mutations$Tr ...
R/methods.R#L69       observed = summary(object@mutation ...
R/methods.R#L72       mean = mean(object@mutations$Depth ...
R/methods.R#L73       median = median(object@mutations$D ...
R/methods.R#L74       sd = sd(object@mutations$Depth), ...
R/methods.R#L75       range = range(object@mutations$Dep ...
R/methods.R#L77   ) ...
R/methods.R#L79   class(stats) <- c("summary.ClonalSimDa ...
R/methods.R#L80   stats ...
R/methods.R#L91   cat("ClonalSim Summary\n") ...
R/methods.R#L92   cat("================================= ...
R/methods.R#L93   cat("Total mutations:", x$n_mutations, ...
R/methods.R#L94   cat("Number of clones:", x$n_clones, " ...
R/methods.R#L95   cat("Tumor purity:", round(x$tumor_pur ...
R/methods.R#L97   cat("\nMutation type counts:\n") ...
R/methods.R#L98   print(x$mutation_types) ...
R/methods.R#L100   cat("\nTrue VAF (biological):\n") ...
R/methods.R#L101   print(x$vaf_summary$true) ...
R/methods.R#L103   cat("\nObserved VAF (with sequencing n ...
R/methods.R#L104   print(x$vaf_summary$observed) ...
R/methods.R#L106   cat("\nSequencing depth:\n") ...
R/methods.R#L107   cat("  Mean:", round(x$depth_summary$m ...
R/methods.R#L108   cat("  Median:", x$depth_summary$media ...
R/methods.R#L109   cat("  SD:", round(x$depth_summary$sd, ...
R/methods.R#L110   cat("  Range:", x$depth_summary$range[ ...
R/methods.R#L112   invisible(x) ...
R/methods.R#L141           function(x, y, type = "vaf_den ...
R/methods.R#L142   mutations <- x@mutations ...
R/methods.R#L143   params <- x@params ...
R/methods.R#L145   if (type == "vaf_density") { ...
R/methods.R#L147       geom_density(fill = "#984EA3", alp ...
R/methods.R#L148       geom_rug(alpha = 0.3, color = "#98 ...
R/methods.R#L149       theme_minimal() + ...
R/methods.R#L150       labs(title = "VAF Density Plot - M ...
R/methods.R#L151            subtitle = paste0(nrow(mutati ...
R/methods.R#L152                            length(params ...
R/methods.R#L153            x = "Variant Allele Frequency ...
R/methods.R#L154            y = "Density") ...
R/methods.R#L158       # Add vertical lines for individua ...
R/methods.R#L159       p <- p + ...
R/methods.R#L161                    linetype = "dashed",  ...
R/methods.R#L163                    linetype = "dashed",  ...
R/methods.R#L165       # Add text labels for each clone ...
R/methods.R#L166       clone_labels <- data.frame( ...
R/methods.R#L171       ) ...
R/methods.R#L173       # Add label for founder (sum of al ...
R/methods.R#L174       founder_label <- data.frame( ...
R/methods.R#L179       ) ...
R/methods.R#L181       # Add germline label if germline v ...
R/methods.R#L182       all_labels <- rbind(clone_labels,  ...
R/methods.R#L183       if (!is.null(params$germline_varia ...
R/methods.R#L185           vaf = 0.5, ...
R/methods.R#L186           label = "Germline", ...
R/methods.R#L187           color = "#984EA3", ...
R/methods.R#L188           stringsAsFactors = FALSE ...
R/methods.R#L194           geom_vline(xintercept = 0.5, ...
R/methods.R#L195                      linetype = "dashed" ...
R/methods.R#L196       } ...
R/methods.R#L198       # Get y position for labels (top o ...
R/methods.R#L199       density_data <- ggplot_build(p)$da ...
R/methods.R#L200       max_density <- max(density_data$de ...
R/methods.R#L202       p <- p + ...
R/methods.R#L204                   aes(x = vaf, y = max_d ...
R/methods.R#L205                   angle = 0, vjust = -0. ...
R/methods.R#L206                   color = all_labels$col ...
R/methods.R#L207                   size = 3.5, fontface = ...
R/methods.R#L208                   inherit.aes = FALSE) ...
R/methods.R#L211   } else if (type == "vaf_scatter") { ...
R/methods.R#L213                      "private" = "#4DAF4 ...
R/methods.R#L215       geom_point(alpha = 0.6, size = 2)  ...
R/methods.R#L216       scale_color_manual(values = type_c ...
R/methods.R#L217       theme_minimal() + ...
R/methods.R#L218       labs(title = "Mutational Profile:  ...
R/methods.R#L219            x = "Mutation Index", ...
R/methods.R#L220            y = "Variant Allele Frequency ...
R/methods.R#L221            color = "Type") ...
R/methods.R#L224       p <- p + ...
R/methods.R#L226                    linetype = "dashed",  ...
R/methods.R#L229   } else if (type == "depth_histogram")  ...
R/methods.R#L231       geom_histogram(bins = 30, fill = " ...
R/methods.R#L232       theme_minimal() + ...
R/methods.R#L233       labs(title = "Sequencing Depth Dis ...
R/methods.R#L234            x = "Depth (read count)", ...
R/methods.R#L235            y = "Number of mutations") ...
R/methods.R#L237   } else if (type == "clone_matrix") { ...
R/methods.R#L240       stop("Clone_IDs column missing fro ...
R/methods.R#L248       clonal_matrix[[paste0("Clone", i)] ...
R/methods.R#L249                                          ...
R/methods.R#L256                                  cols =  ...
R/methods.R#L257                                  names_t ...
R/methods.R#L258                                  values_ ...
R/methods.R#L261       geom_tile(color = "white", linewid ...
R/methods.R#L262       scale_fill_manual(values = c("FALS ...
R/methods.R#L264       theme_minimal() + ...
R/methods.R#L265       labs(title = "Mutation Presence Ma ...
R/methods.R#L266            subtitle = "Ordered by decrea ...
R/methods.R#L267            x = "Subclone", ...
R/methods.R#L268            y = "Mutation (ordered by VAF ...
R/methods.R#L269            fill = "Status") + ...
R/methods.R#L270       theme(axis.text.y = element_blank( ...
R/methods.R#L274   } else { ...
R/methods.R#L276          "depth_histogram, clone_matrix" ...
R/methods.R#L277   } ...
R/methods.R#L279   return(p) ...
R/noise_model.R#L38   if (n_mutations == 0) return(numeric(0 ...
R/noise_model.R#L39   if (true_freq < 0 || true_freq > 1) { ...
R/noise_model.R#L41   } ...
R/noise_model.R#L42   if (concentration <= 0) { ...
R/noise_model.R#L44   } ...
R/noise_model.R#L46   # Beta distribution parameters ...
R/noise_model.R#L47   alpha <- true_freq * concentration ...
R/noise_model.R#L48   beta <- (1 - true_freq) * concentratio ...
R/noise_model.R#L50   # Avoid degenerate cases ...
R/noise_model.R#L51   alpha <- pmax(alpha, 0.1) ...
R/noise_model.R#L52   beta <- pmax(beta, 0.1) ...
R/noise_model.R#L54   # Sample from Beta distribution ...
R/noise_model.R#L55   noisy_freq <- rbeta(n_mutations, shape ...
R/noise_model.R#L57   # Limit to reasonable range ...
R/noise_model.R#L58   noisy_freq <- pmax(0.01, pmin(0.99, no ...
R/noise_model.R#L60   return(noisy_freq) ...
R/noise_model.R#L103                           distribution = ...
R/noise_model.R#L104                           dispersion = 2 ...
R/noise_model.R#L105   if (mean_depth <= 0) { ...
R/noise_model.R#L107   } ...
R/noise_model.R#L109   if (distribution == "negative_binomial ...
R/noise_model.R#L111       stop("dispersion must be positive" ...
R/noise_model.R#L115   } else if (distribution == "poisson")  ...
R/noise_model.R#L118   } else if (distribution == "uniform")  ...
R/noise_model.R#L121   } else { ...
R/noise_model.R#L123   } ...
R/noise_model.R#L125   # Ensure minimum depth of 10 ...
R/noise_model.R#L126   depths <- pmax(depths, 10L) ...
R/noise_model.R#L128   return(as.integer(depths)) ...
R/noise_model.R#L177   if (length(true_vaf) != length(depth)) ...
R/noise_model.R#L179   } ...
R/noise_model.R#L180   if (any(true_vaf < 0 | true_vaf > 1, n ...
R/noise_model.R#L182   } ...
R/noise_model.R#L183   if (any(depth <= 0, na.rm = TRUE)) { ...
R/noise_model.R#L185   } ...
R/noise_model.R#L186   if (error_rate < 0 || error_rate > 1)  ...
R/noise_model.R#L188   } ...
R/noise_model.R#L190   # Observed VAF includes sequencing err ...
R/noise_model.R#L191   observed_vaf <- true_vaf + error_rate ...
R/noise_model.R#L192   observed_vaf <- pmin(observed_vaf, 0.9 ...
R/noise_model.R#L194   # Sample alt reads from binomial distr ...
R/noise_model.R#L195   alt_reads <- rbinom(length(true_vaf),  ...
R/noise_model.R#L197   # Calculate observed VAF from read cou ...
R/noise_model.R#L198   final_vaf <- alt_reads / depth ...
R/noise_model.R#L200   # Ensure alt_reads doesn't exceed dept ...
R/noise_model.R#L201   alt_reads <- pmin(alt_reads, depth) ...
R/noise_model.R#L203   return(list( ...
R/noise_model.R#L207   )) ...
R/simulateTumor.R#L90       enabled = TRUE, ...
R/simulateTumor.R#L91       mean_depth = 100, ...
R/simulateTumor.R#L92       depth_variation = "negative_binomi ...
R/simulateTumor.R#L93       depth_dispersion = 20, ...
R/simulateTumor.R#L94       error_rate = 0.001, ...
R/simulateTumor.R#L95       binomial_sampling = TRUE ...
R/simulateTumor.R#L98       enabled = FALSE, ...
R/simulateTumor.R#L99       n_variants = 50, ...
R/simulateTumor.R#L100       vaf_expected = 0.5 ...
R/simulateTumor.R#L105   # Input validation ...
R/simulateTumor.R#L106   if (any(subclone_freqs < 0) || any(sub ...
R/simulateTumor.R#L108   } ...
R/simulateTumor.R#L109   if (sum(subclone_freqs) > 1) { ...
R/simulateTumor.R#L111   } ...
R/simulateTumor.R#L112   if (length(n_mut_per_clone) != length( ...
R/simulateTumor.R#L114   } ...
R/simulateTumor.R#L116   # Set seed for reproducibility ...
R/simulateTumor.R#L117   if (!is.null(seed)) { ...
R/simulateTumor.R#L119   } ...
R/simulateTumor.R#L121   # Store clone names ...
R/simulateTumor.R#L122   names(subclone_freqs) <- paste0("Clone ...
R/simulateTumor.R#L124   # Fill in default noise parameters if  ...
R/simulateTumor.R#L125   if (!"enabled" %in% names(biological_n ...
R/simulateTumor.R#L127   } ...
R/simulateTumor.R#L128   if (!"concentration" %in% names(biolog ...
R/simulateTumor.R#L130   } ...
R/simulateTumor.R#L132   if (!"enabled" %in% names(sequencing_n ...
R/simulateTumor.R#L134   } ...
R/simulateTumor.R#L135   if (!"mean_depth" %in% names(sequencin ...
R/simulateTumor.R#L137   } ...
R/simulateTumor.R#L138   if (!"depth_variation" %in% names(sequ ...
R/simulateTumor.R#L140   } ...
R/simulateTumor.R#L141   if (!"depth_dispersion" %in% names(seq ...
R/simulateTumor.R#L143   } ...
R/simulateTumor.R#L144   if (!"error_rate" %in% names(sequencin ...
R/simulateTumor.R#L146   } ...
R/simulateTumor.R#L147   if (!"binomial_sampling" %in% names(se ...
R/simulateTumor.R#L149   } ...
R/simulateTumor.R#L151   # Generate mutations ...
R/simulateTumor.R#L152   mutation_list <- list() ...
R/simulateTumor.R#L153   idx <- 1 ...
R/simulateTumor.R#L155   # 1. Founder mutations (present in all ...
R/simulateTumor.R#L156   founder_freq <- sum(subclone_freqs) ...
R/simulateTumor.R#L157   mutation_list[[idx]] <- .generate_muta ...
R/simulateTumor.R#L164   ) ...
R/simulateTumor.R#L165   idx <- idx + 1 ...
R/simulateTumor.R#L167   # 2. Shared mutations between subgroup ...
R/simulateTumor.R#L168   for (i in seq_along(n_mut_shared)) { ...
R/simulateTumor.R#L173       warning("Shared mutation group '", ...
R/simulateTumor.R#L174               "' references non-existent ...
R/simulateTumor.R#L175       next ...
R/simulateTumor.R#L181       n_mut_shared[[i]], ...
R/simulateTumor.R#L182       shared_freq, ...
R/simulateTumor.R#L183       clone_ids = shared_clones, ...
R/simulateTumor.R#L184       type = "shared", ...
R/simulateTumor.R#L185       bio_noise = biological_noise, ...
R/simulateTumor.R#L186       seq_noise = sequencing_noise ...
R/simulateTumor.R#L189   } ...
R/simulateTumor.R#L191   # 3. Private mutations for each subclo ...
R/simulateTumor.R#L192   for (i in seq_along(subclone_freqs)) { ...
R/simulateTumor.R#L194       n_mut_per_clone[i], ...
R/simulateTumor.R#L195       subclone_freqs[i], ...
R/simulateTumor.R#L196       clone_ids = i, ...
R/simulateTumor.R#L197       type = "private", ...
R/simulateTumor.R#L198       bio_noise = biological_noise, ...
R/simulateTumor.R#L199       seq_noise = sequencing_noise ...
R/simulateTumor.R#L202   } ...
R/simulateTumor.R#L204   # 4. Germline variants (if enabled) ...
R/simulateTumor.R#L205   if (!is.null(germline_variants) && ger ...
R/simulateTumor.R#L208       germline_variants$n_variants <- 50 ...
R/simulateTumor.R#L211       germline_variants$vaf_expected <-  ...
R/simulateTumor.R#L227       germline_variants$n_variants, ...
R/simulateTumor.R#L228       germline_vaf, ...
R/simulateTumor.R#L229       clone_ids = "germline", ...
R/simulateTumor.R#L230       type = "germline", ...
R/simulateTumor.R#L231       bio_noise = biological_noise, ...
R/simulateTumor.R#L232       seq_noise = sequencing_noise ...
R/simulateTumor.R#L235   } ...
R/simulateTumor.R#L237   # Combine all mutations ...
R/simulateTumor.R#L238   mutation_list <- mutation_list[!vapply ...
R/simulateTumor.R#L239   complete_data <- do.call(rbind, mutati ...
R/simulateTumor.R#L241   # Add genomic coordinates (random, for ...
R/simulateTumor.R#L242   complete_data$Chromosome <- sample(pas ...
R/simulateTumor.R#L243                                       nr ...
R/simulateTumor.R#L244   complete_data$Position <- sample(1e6:2 ...
R/simulateTumor.R#L245   complete_data$Ref <- sample(c("A", "T" ...
R/simulateTumor.R#L246                                nrow(comp ...
R/simulateTumor.R#L247   complete_data$Alt <- sample(c("A", "T" ...
R/simulateTumor.R#L248                                nrow(comp ...
R/simulateTumor.R#L250   # Reorder columns ...
R/simulateTumor.R#L251   complete_data <- complete_data[, c("Mu ...
R/simulateTumor.R#L252                                       "R ...
R/simulateTumor.R#L253                                       "D ...
R/simulateTumor.R#L254                                       "C ...
R/simulateTumor.R#L256   # Create clonal structure data frame ...
R/simulateTumor.R#L257   clonal_structure <- data.frame( ...
R/simulateTumor.R#L262   ) ...
R/simulateTumor.R#L264   # Store parameters ...
R/simulateTumor.R#L265   params <- list( ...
R/simulateTumor.R#L273   ) ...
R/simulateTumor.R#L275   # Create metadata ...
R/simulateTumor.R#L276   metadata <- list( ...
R/simulateTumor.R#L280   ) ...
R/simulateTumor.R#L282   # Create and return ClonalSimData obje ...
R/simulateTumor.R#L283   result <- ClonalSimData( ...
R/simulateTumor.R#L288   ) ...
R/simulateTumor.R#L290   return(result) ...
R/simulateTumor.R#L300   if (n_mut == 0) return(NULL) ...
R/simulateTumor.R#L302   # Generate mutation names ...
R/simulateTumor.R#L303   if (type == "founder") { ...
R/simulateTumor.R#L306   } else if (type == "shared") { ...
R/simulateTumor.R#L310   } else if (type == "germline") { ...
R/simulateTumor.R#L314   } else { ...
R/simulateTumor.R#L317   } ...
R/simulateTumor.R#L319   # Step 1: Apply biological noise ...
R/simulateTumor.R#L320   if (bio_noise$enabled) { ...
R/simulateTumor.R#L322   } else { ...
R/simulateTumor.R#L324   } ...
R/simulateTumor.R#L326   # Step 2: Simulate depth ...
R/simulateTumor.R#L327   if (seq_noise$enabled) { ...
R/simulateTumor.R#L329       n_mut, ...
R/simulateTumor.R#L330       mean_depth = seq_noise$mean_depth, ...
R/simulateTumor.R#L331       distribution = seq_noise$depth_var ...
R/simulateTumor.R#L332       dispersion = seq_noise$depth_dispe ...
R/simulateTumor.R#L334   } else { ...
R/simulateTumor.R#L336   } ...
R/simulateTumor.R#L338   # Step 3: Apply technical sequencing n ...
R/simulateTumor.R#L339   if (seq_noise$enabled && seq_noise$bin ...
R/simulateTumor.R#L343   } else { ...
R/simulateTumor.R#L346   } ...
R/simulateTumor.R#L348   # Create data frame ...
R/simulateTumor.R#L349   data.frame( ...
R/simulateTumor.R#L359   ) ...
R/utils.R#L9   # ggplot2 aesthetics ...
R/utils.R#L10   "VAF", ...
R/utils.R#L11   "Type", ...
R/utils.R#L12   "Depth", ...
R/utils.R#L13   "Clone", ...
R/utils.R#L14   "Index", ...
R/utils.R#L15   "Present", ...
R/utils.R#L16   "vaf", ...
R/utils.R#L17   "label" ...
vignettes/Introduction_to_ClonalSim.Rmd#L17   collapse = TRUE, ...
vignettes/Introduction_to_ClonalSim.Rmd#L18   comment = "#>", ...
vignettes/Introduction_to_ClonalSim.Rmd#L19   fig.width = 8, ...
vignettes/Introduction_to_ClonalSim.Rmd#L20   fig.height = 6, ...
vignettes/Introduction_to_ClonalSim.Rmd#L21   warning = FALSE, ...
vignettes/Introduction_to_ClonalSim.Rmd#L22   message = FALSE ...
vignettes/Introduction_to_ClonalSim.Rmd#L43    - Depth overdispersion (negative bino ...
vignettes/Introduction_to_ClonalSim.Rmd#L44    - Stochastic read sampling (binomial) ...
vignettes/Introduction_to_ClonalSim.Rmd#L45    - Base calling errors (Illumina-like) ...
vignettes/Introduction_to_ClonalSim.Rmd#L73   subclone_freqs = c(0.15, 0.25, 0.30, 0 ...
vignettes/Introduction_to_ClonalSim.Rmd#L74   n_mut_per_clone = c(20, 25, 30, 15), ...
vignettes/Introduction_to_ClonalSim.Rmd#L75   n_mut_founder = 10, ...
vignettes/Introduction_to_ClonalSim.Rmd#L76   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L137   subclone_freqs = c(0.3, 0.4, 0.3), ...
vignettes/Introduction_to_ClonalSim.Rmd#L138   n_mut_per_clone = c(30, 40, 30), ...
vignettes/Introduction_to_ClonalSim.Rmd#L139   biological_noise = list(enabled = TRUE ...
vignettes/Introduction_to_ClonalSim.Rmd#L140   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L145   subclone_freqs = c(0.3, 0.4, 0.3), ...
vignettes/Introduction_to_ClonalSim.Rmd#L146   n_mut_per_clone = c(30, 40, 30), ...
vignettes/Introduction_to_ClonalSim.Rmd#L147   biological_noise = list(enabled = TRUE ...
vignettes/Introduction_to_ClonalSim.Rmd#L148   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L154      xlab = "True VAF", breaks = 30, col ...
vignettes/Introduction_to_ClonalSim.Rmd#L156      xlab = "True VAF", breaks = 30, col ...
vignettes/Introduction_to_ClonalSim.Rmd#L169   sequencing_noise = list( ...
vignettes/Introduction_to_ClonalSim.Rmd#L173   ), ...
vignettes/Introduction_to_ClonalSim.Rmd#L174   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L179   sequencing_noise = list( ...
vignettes/Introduction_to_ClonalSim.Rmd#L182   ), ...
vignettes/Introduction_to_ClonalSim.Rmd#L183   seed = 124 ...
vignettes/Introduction_to_ClonalSim.Rmd#L188      xlab = "Depth", breaks = 30, col =  ...
vignettes/Introduction_to_ClonalSim.Rmd#L190      xlab = "Depth", breaks = 30, col =  ...
vignettes/Introduction_to_ClonalSim.Rmd#L201   sequencing_noise = list(binomial_sampl ...
vignettes/Introduction_to_ClonalSim.Rmd#L202   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L207   sequencing_noise = list(binomial_sampl ...
vignettes/Introduction_to_ClonalSim.Rmd#L208   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L214   plot(True_VAF, VAF, main = "With Binom ...
vignettes/Introduction_to_ClonalSim.Rmd#L215        xlab = "True VAF", ylab = "Observ ...
vignettes/Introduction_to_ClonalSim.Rmd#L216   abline(0, 1, col = "red", lty = 2) ...
vignettes/Introduction_to_ClonalSim.Rmd#L219   plot(True_VAF, VAF, main = "Without Bi ...
vignettes/Introduction_to_ClonalSim.Rmd#L220        xlab = "True VAF", ylab = "Observ ...
vignettes/Introduction_to_ClonalSim.Rmd#L221   abline(0, 1, col = "red", lty = 2) ...
vignettes/Introduction_to_ClonalSim.Rmd#L233   subclone_freqs = c(0.05, 0.10, 0.15),  ...
vignettes/Introduction_to_ClonalSim.Rmd#L234   n_mut_per_clone = c(20, 25, 30), ...
vignettes/Introduction_to_ClonalSim.Rmd#L235   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L248   sequencing_noise = list( ...
vignettes/Introduction_to_ClonalSim.Rmd#L253   ), ...
vignettes/Introduction_to_ClonalSim.Rmd#L254   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L267   sequencing_noise = list( ...
vignettes/Introduction_to_ClonalSim.Rmd#L271   ), ...
vignettes/Introduction_to_ClonalSim.Rmd#L272   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L284   biological_noise = list(enabled = FALS ...
vignettes/Introduction_to_ClonalSim.Rmd#L285   sequencing_noise = list(enabled = FALS ...
vignettes/Introduction_to_ClonalSim.Rmd#L286   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L300   subclone_freqs = c(0.3, 0.4),  # 70% t ...
vignettes/Introduction_to_ClonalSim.Rmd#L301   n_mut_per_clone = c(40, 50), ...
vignettes/Introduction_to_ClonalSim.Rmd#L302   germline_variants = list( ...
vignettes/Introduction_to_ClonalSim.Rmd#L306   ), ...
vignettes/Introduction_to_ClonalSim.Rmd#L307   seed = 789 ...
vignettes/Introduction_to_ClonalSim.Rmd#L388   subclone_freqs = c(0.2, 0.3, 0.5), ...
vignettes/Introduction_to_ClonalSim.Rmd#L389   n_mut_per_clone = c(50, 75, 50), ...
vignettes/Introduction_to_ClonalSim.Rmd#L390   seed = 42 ...
vignettes/Introduction_to_ClonalSim.Rmd#L417   subclone_freqs = c(0.1, 0.15, 0.2, 0.2 ...
vignettes/Introduction_to_ClonalSim.Rmd#L418   n_mut_per_clone = c(30, 40, 50, 40, 30 ...
vignettes/Introduction_to_ClonalSim.Rmd#L419   n_mut_shared = list( ...
vignettes/Introduction_to_ClonalSim.Rmd#L424   ), ...
vignettes/Introduction_to_ClonalSim.Rmd#L425   seed = 123 ...
vignettes/Introduction_to_ClonalSim.Rmd#L447    Present, and the Future.* Cell. 2017 ...
vignettes/Introduction_to_ClonalSim.Rmd#L449    Architecture of Cancers.* Cold Spring ...
vignettes/Introduction_to_ClonalSim.Rmd#L451    in cancer.* Nat Methods. 2014 ...
vignettes/Introduction_to_ClonalSim.Rmd#L453    spatial and temporal patterns of tumo ...
Checking if package already exists in CRAN... OK
Checking if new package already exists in Bioconductor... OK
Checking for bioc-devel mailing list subscription...
Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
Checking for support site registration...
Add package to Watched Tags in your Support Site profile; visit https://support.bioconductor.org/accounts/edit/profile
